<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratorio Virtual de F√≠sica: Arqu√≠medes y Centroide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            color-scheme: light;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        button:focus-visible,
        input:focus-visible {
            outline: 3px solid rgba(59, 130, 246, 0.45);
            outline-offset: 2px;
        }
        .tab-active {
            border-color: #3b82f6;
            color: #1d4ed8;
            background-color: #eff6ff;
        }
        .tab-inactive {
            border-color: transparent;
            color: #6b7280;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 520px;
            margin-left: auto;
            margin-right: auto;
            height: 280px;
            max-height: 350px;
        }
        .simulation-canvas {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
        }
        input[type=range]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3b82f6;
            cursor: pointer;
            border-radius: 50%;
        }
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex flex-wrap gap-4 justify-between items-center">
            <div class="flex items-center space-x-4">
                <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-lg" aria-hidden="true">
                    <span>F</span>
                </div>
                <div>
                    <h1 class="text-xl md:text-2xl font-bold text-gray-800">Laboratorio de F√≠sica</h1>
                    <p class="text-sm text-gray-500 mt-1">Exploraci√≥n interactiva de Arqu√≠medes y centroides</p>
                </div>
            </div>
            <div class="flex items-center space-x-2 sm:space-x-4">
                <button id="btn-arquimedes" class="px-3 sm:px-4 py-2 text-sm sm:text-base font-semibold rounded-lg transition-colors duration-200 tab-active" aria-controls="view-arquimedes">Arqu√≠medes</button>
                <button id="btn-centroide" class="px-3 sm:px-4 py-2 text-sm sm:text-base font-semibold rounded-lg transition-colors duration-200 tab-inactive" aria-controls="view-centroide">Centroide</button>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-16">

        <!-- M√ìDULO: PRINCIPIO DE ARQU√çMEDES -->
        <section id="view-arquimedes">
            <div class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-bold text-blue-600">Principio de Arqu√≠medes y Flotaci√≥n</h2>
                <p class="mt-3 text-lg text-gray-600 max-w-3xl mx-auto">Manipula par√°metros de un objeto sumergido para visualizar c√≥mo interact√∫an el peso y el empuje. Ideal para que las leyes del flotador no queden ‚Äúa la deriva‚Äù.</p>
            </div>

            <div class="bg-blue-50 border border-blue-100 p-5 rounded-xl mb-8">
                <h3 class="text-lg font-semibold text-blue-700 mb-2">Objetivos de aprendizaje</h3>
                <ul class="list-disc list-inside text-blue-900/80 space-y-1">
                    <li>Describir c√≥mo se genera el empuje hidrost√°tico a partir de la variaci√≥n de presi√≥n.</li>
                    <li>Aplicar \( E = \rho_{\text{fluido}} g V_{\text{sumergido}} \) para predecir flotaci√≥n o hundimiento.</li>
                    <li>Relacionar densidades relativas con el porcentaje sumergido de un cuerpo.</li>
                </ul>
            </div>
            
            <!-- SECCI√ìN TE√ìRICA -->
            <div class="bg-white p-6 rounded-2xl shadow-lg mb-10">
                <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"><span aria-hidden="true">üìò</span>Fundamentos Te√≥ricos</h3>
                <p class="text-gray-500 mb-5">Navega por las pesta√±as seg√∫n la profundidad que quieras explorar.</p>
                <div class="border-b border-gray-200 overflow-x-auto">
                    <nav class="-mb-px flex space-x-6 min-w-max" aria-label="Pesta√±as Arqu√≠medes">
                        <button class="arquimedes-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-active" data-tab="teoria-arq">Teor√≠a</button>
                        <button class="arquimedes-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-inactive" data-tab="ecuaciones-arq">Ecuaciones</button>
                        <button class="arquimedes-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-inactive" data-tab="aplicaciones-arq">Aplicaciones</button>
                        <button class="arquimedes-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-inactive" data-tab="errores-arq">Errores frecuentes</button>
                    </nav>
                </div>
                <div id="tab-content-arquimedes" class="mt-6 text-gray-700 space-y-4 leading-relaxed">
                    <div id="teoria-arq">
                        <p>El principio de Arqu√≠medes indica que todo cuerpo sumergido en un fluido en reposo experimenta un empuje vertical hacia arriba igual al peso del fluido desalojado. Este empuje aparece porque la presi√≥n aumenta con la profundidad, de modo que la base del objeto recibe una fuerza mayor que su parte superior.</p>
                        <p>Cuando el empuje iguala al peso, el objeto alcanza equilibrio flotante. Si aumentas la densidad del objeto manteniendo el volumen constante, su peso crece y puede hundirse. Si la densidad del objeto es menor que la del fluido, el equilibrio se logra con una fracci√≥n del volumen por debajo de la superficie.</p>
                    </div>
                    <div id="ecuaciones-arq" class="hidden space-y-3">
                        <p><strong>Fuerza de empuje:</strong> \( E = \rho_{\text{fluido}}\, g\, V_{\text{sumergido}} \)</p>
                        <p><strong>Peso del objeto:</strong> \( P = \rho_{\text{objeto}}\, g\, V_{\text{objeto}} \)</p>
                        <p><strong>Condiciones de comportamiento:</strong></p>
                        <ul class="list-disc list-inside space-y-1 ms-1">
                            <li>\( E = P \Rightarrow \) flotaci√≥n en equilibrio (puede estar parcialmente sumergido).</li>
                            <li>\( E < P \Rightarrow \) el cuerpo se hunde.</li>
                            <li>\( \dfrac{V_{\text{sumergido}}}{V_{\text{objeto}}} = \dfrac{\rho_{\text{objeto}}}{\rho_{\text{fluido}}} \) cuando flota parcialmente.</li>
                        </ul>
                        <p>La magnitud \( \rho_{\text{objeto}}/\rho_{\text{fluido}} \) se conoce como densidad relativa. Valores menores que 1 implican flotaci√≥n; valores mayores o iguales a 1 conducen al hundimiento.</p>
                    </div>
                    <div id="aplicaciones-arq" class="hidden space-y-3">
                        <p>El principio se emplea en el dise√±o naval (c√°lculo del desplazamiento de un casco), en submarinos (tanques de lastre ajustan la masa efectiva) y en globos aerost√°ticos (el fluido es el aire). Tambi√©n sustenta instrumentos como dens√≠metros y hidr√≥metros para caracterizar l√≠quidos.</p>
                        <p>En ingenier√≠a biom√©dica, el an√°lisis de flotabilidad ayuda a estimar composiciones corporales mediante pesaje hidrost√°tico. Incluso en videojuegos o simuladores f√≠sicos se implementa para lograr comportamientos realistas de objetos en agua.</p>
                    </div>
                    <div id="errores-arq" class="hidden space-y-3">
                        <ul class="list-disc list-inside space-y-2">
                            <li><strong>Confundir volumen desplazado con volumen total:</strong> solo la parte sumergida aporta al empuje.</li>
                            <li><strong>Olvidar la direcci√≥n del empuje:</strong> siempre es vertical y hacia arriba, no perpendicular a la superficie del objeto.</li>
                            <li><strong>Usar \(g\) incorrecto:</strong> trabaja con \( g = 9.81\, \text{m/s}^2 \) salvo que el problema indique otro valor.</li>
                            <li><strong>Comparar masas en lugar de pesos:</strong> la condici√≥n de equilibrio es \( E = P \), no \( \rho_{\text{fluido}} = \rho_{\text{objeto}} \).</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- LABORATORIO INTERACTIVO -->
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <div class="flex flex-col gap-2 items-center text-center mb-6">
                    <h3 class="text-2xl font-bold text-blue-600">Laboratorio Interactivo de Flotaci√≥n</h3>
                    <p class="text-gray-600 max-w-2xl">Ajusta densidades y volumen para observar el comportamiento del objeto. El panel interpreta los resultados en un lenguaje apto para navegantes principiantes.</p>
                    <div class="bg-gray-100 text-gray-700 px-4 py-2 rounded-full text-sm font-medium">Consejo: trabaja con unidades coherentes (kg/m¬≥ para densidad, m¬≥ para volumen).</div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-start">
                    <!-- CONTROLES -->
                    <div class="space-y-6">
                        <div>
                            <label for="densidad-objeto" class="block font-medium mb-1">Densidad del objeto (kg/m¬≥): <span id="val-densidad-objeto" class="font-bold text-blue-600" aria-live="polite"></span></label>
                            <input type="range" id="densidad-objeto" min="100" max="2500" value="400" step="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" aria-valuemin="100" aria-valuemax="2500" aria-valuenow="400" aria-label="Densidad del objeto">
                        </div>
                        <div>
                            <label for="densidad-fluido" class="block font-medium mb-1">Densidad del fluido (kg/m¬≥): <span id="val-densidad-fluido" class="font-bold text-blue-600" aria-live="polite"></span></label>
                            <input type="range" id="densidad-fluido" min="500" max="1800" value="1000" step="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" aria-valuemin="500" aria-valuemax="1800" aria-valuenow="1000" aria-label="Densidad del fluido">
                        </div>
                        <div>
                            <label for="volumen-objeto" class="block font-medium mb-1">Volumen del objeto (m¬≥): <span id="val-volumen-objeto" class="font-bold text-blue-600" aria-live="polite"></span></label>
                            <input type="range" id="volumen-objeto" min="0.05" max="1.5" value="0.5" step="0.05" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" aria-valuemin="0.05" aria-valuemax="1.5" aria-valuenow="0.5" aria-label="Volumen del objeto">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4 text-center">
                            <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                                <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Peso del objeto</h4>
                                <p id="resultado-peso" class="text-2xl font-bold mt-1"></p>
                                <p class="text-xs text-gray-500">\(P = \rho_{\text{obj}} g V\)</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                                <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Empuje</h4>
                                <p id="resultado-empuje" class="text-2xl font-bold mt-1"></p>
                                <p class="text-xs text-gray-500">\(E = \rho_{\text{fluido}} g V_{\text{sum}}\)</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                                <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Vol. sumergido</h4>
                                <p id="resultado-volumen-sumergido" class="text-2xl font-bold mt-1"></p>
                                <p class="text-xs text-gray-500">Solo lo que desplaza fluido</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                                <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Densidad relativa</h4>
                                <p id="resultado-densidad-relativa" class="text-2xl font-bold mt-1"></p>
                                <p class="text-xs text-gray-500">\(\rho_{\text{obj}}/\rho_{\text{fluido}}\)</p>
                            </div>
                        </div>
                        <div id="estado-flotacion" class="p-4 rounded-xl text-center text-xl font-bold transition-colors duration-300"></div>
                        <div id="explicacion-flotacion" class="bg-blue-50 border border-blue-100 text-blue-900/90 p-4 rounded-xl text-sm leading-relaxed" aria-live="polite"></div>
                    </div>
                    <!-- VISUALIZACI√ìN -->
                    <div class="flex flex-col items-center gap-6">
                        <canvas id="simulacion-arquimedes" width="420" height="420" class="simulation-canvas w-full max-w-md" role="img" aria-label="Simulaci√≥n de objeto flotando o hundi√©ndose"></canvas>
                        <div class="chart-container mt-2">
                            <canvas id="grafico-fuerzas" aria-label="Gr√°fico comparativo Peso vs Empuje" role="img"></canvas>
                        </div>
                        <div class="w-full max-w-md bg-gray-100 text-gray-600 text-sm p-4 rounded-xl">
                            <h4 class="font-semibold text-gray-700 mb-2">C√≥mo usar este laboratorio</h4>
                            <ol class="list-decimal list-inside space-y-1">
                                <li>Elige el fluido (agua, aceite, etc.) ajustando la densidad.</li>
                                <li>Configura densidad y volumen del objeto (piensa en madera, hierro, hielo).</li>
                                <li>Observa el porcentaje sumergido y compara las barras de fuerza.</li>
                                <li>Interpreta la narraci√≥n para conectar teor√≠a con el resultado num√©rico.</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- M√ìDULO: CENTROIDE DE √ÅREA -->
        <section id="view-centroide" class="hidden">
            <div class="text-center mb-8">
                <h2 class="text-3xl md:text-4xl font-bold text-blue-600">Centroide de √Årea</h2>
                <p class="mt-3 text-lg text-gray-600 max-w-3xl mx-auto">Comp√≥n l√°minas rectangulares y observa c√≥mo el centro geom√©trico responde a cada suma o hueco.</p>
            </div>

            <div class="bg-emerald-50 border border-emerald-100 p-5 rounded-xl mb-8">
                <h3 class="text-lg font-semibold text-emerald-700 mb-2">Objetivos de aprendizaje</h3>
                <ul class="list-disc list-inside text-emerald-900/85 space-y-1">
                    <li>Aplicar el m√©todo de momentos de √°rea para obtener \(X_c\) y \(Y_c\).</li>
                    <li>Gestionar √°reas negativas (huecos) y reconocer su efecto en la suma total.</li>
                    <li>Visualizar c√≥mo la posici√≥n de cada pieza contribuye al equilibrio geom√©trico.</li>
                </ul>
            </div>

            <!-- SECCI√ìN TE√ìRICA -->
            <div class="bg-white p-6 rounded-2xl shadow-lg mb-10">
                <h3 class="text-2xl font-bold mb-4 flex items-center gap-2"><span aria-hidden="true">üìê</span>Fundamentos Te√≥ricos</h3>
                <div class="border-b border-gray-200 overflow-x-auto">
                    <nav class="-mb-px flex space-x-6 min-w-max" aria-label="Pesta√±as Centroide">
                        <button class="centroide-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-active" data-tab="teoria-cen">Teor√≠a</button>
                        <button class="centroide-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-inactive" data-tab="ecuaciones-cen">Ecuaciones</button>
                        <button class="centroide-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-inactive" data-tab="metodo-cen">M√©todo</button>
                        <button class="centroide-tab whitespace-nowrap py-3 px-1 border-b-2 font-semibold text-sm tab-inactive" data-tab="errores-cen">Errores frecuentes</button>
                    </nav>
                </div>
                <div id="tab-content-centroide" class="mt-6 text-gray-700 space-y-4 leading-relaxed">
                    <div id="teoria-cen">
                        <p>El centroide de un √°rea plana homog√©nea coincide con la posici√≥n del centro de masa si la l√°mina fuese delgada y de densidad uniforme. Para figuras simples (rect√°ngulo, tri√°ngulo, c√≠rculo) los centroides est√°n tabulados. Cuando la figura es compuesta, se calcula combinando las √°reas de cada componente.</p>
                        <p>Elegir un sistema de referencia (ejes \(X\) e \(Y\)) es esencial: todas las coordenadas se miden respecto a ese origen. Al incluir huecos, su contribuci√≥n se considera con √°rea negativa, lo que desplaza el centroide hacia el lado opuesto.</p>
                    </div>
                    <div id="ecuaciones-cen" class="hidden space-y-3">
                        <p><strong>Coordenada en \(X\):</strong> \[ X_c = \frac{\sum (A_i \, x_i)}{\sum A_i} \]</p>
                        <p><strong>Coordenada en \(Y\):</strong> \[ Y_c = \frac{\sum (A_i \, y_i)}{\sum A_i} \]</p>
                        <p>Donde \( A_i \) es el √°rea (positiva o negativa) de la figura \(i\), y \( (x_i, y_i) \) es el centroide individual medido desde el origen com√∫n.</p>
                        <p>Recuerda que si \( \sum A_i = 0 \), el centroide no est√° definido (el sistema estar√≠a ‚Äúflotando‚Äù sin √°rea neta).</p>
                    </div>
                    <div id="metodo-cen" class="hidden space-y-3">
                        <ol class="list-decimal list-inside space-y-2">
                            <li><strong>Planificar:</strong> dibuja la figura, define ejes y selecciona unidades (mm, cm, m).</li>
                            <li><strong>Descomponer:</strong> separa en figuras simples. Usa √°reas negativas para vac√≠os o recortes.</li>
                            <li><strong>Calcular:</strong> obtiene \(A_i\), \(x_i\), \(y_i\) usando tablas o f√≥rmulas conocidas.</li>
                            <li><strong>Sumar:</strong> completa una tabla con \(A_i\), \(A_i x_i\) y \(A_i y_i\). Presta atenci√≥n a los signos.</li>
                            <li><strong>Dividir:</strong> aplica las ecuaciones de \(X_c\) y \(Y_c\).</li>
                            <li><strong>Verificar:</strong> usa simetr√≠a o un c√°lculo aproximado para confirmar que el resultado ‚Äútiene sentido‚Äù.</li>
                        </ol>
                    </div>
                    <div id="errores-cen" class="hidden space-y-3">
                        <ul class="list-disc list-inside space-y-2">
                            <li>No homogeneizar unidades (mezclar mm con m conduce a errores de escala enormes).</li>
                            <li>Asignar coordenadas de centroides negativos incorrectas (los huecos mantienen el mismo \(x_i, y_i\); solo cambia el signo del √°rea).</li>
                            <li>Olvidar restar las √°reas recortadas al √°rea total, lo que provoca valores enga√±osos de \(X_c\) y \(Y_c\).</li>
                            <li>Interpretar \(Y_c\) desde la parte superior del dibujo cuando el origen se ubic√≥ en la base.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- LABORATORIO INTERACTIVO -->
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <div class="flex flex-col gap-2 items-center text-center mb-6">
                    <h3 class="text-2xl font-bold text-blue-600">Laboratorio Interactivo de Centroide</h3>
                    <p class="text-gray-600 max-w-2xl">A√±ade rect√°ngulos positivos o negativos, observa c√≥mo se actualiza la tabla de c√°lculo y halla el centroide compuesto con el apoyo del lienzo.</p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-start">
                    <!-- CONTROLES Y TABLA -->
                    <div class="space-y-6">
                        <div class="bg-gray-50 p-4 rounded-2xl border border-gray-200">
                            <h4 class="text-lg font-semibold mb-3 flex items-center gap-2"><span aria-hidden="true">‚ûï</span>A√±adir figura rectangular</h4>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="fig-x" class="block text-sm font-medium text-gray-700">Posici√≥n X (desde el origen)</label>
                                    <input type="number" id="fig-x" value="20" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm" aria-describedby="ayuda-coordenadas">
                                </div>
                                <div>
                                    <label for="fig-y" class="block text-sm font-medium text-gray-700">Posici√≥n Y (desde el origen)</label>
                                    <input type="number" id="fig-y" value="20" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                                </div>
                                <div>
                                    <label for="fig-w" class="block text-sm font-medium text-gray-700">Ancho</label>
                                    <input type="number" id="fig-w" value="100" min="1" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                                </div>
                                <div>
                                    <label for="fig-h" class="block text-sm font-medium text-gray-700">Alto</label>
                                    <input type="number" id="fig-h" value="150" min="1" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm">
                                </div>
                            </div>
                            <p id="ayuda-coordenadas" class="text-xs text-gray-500 mt-2">Las coordenadas corresponden a la esquina inferior izquierda de la figura.</p>
                            <div class="mt-4 flex flex-wrap gap-3 justify-between items-center">
                                <label class="flex items-center gap-2 text-sm text-gray-700">
                                    <input id="fig-negativa" type="checkbox" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                    √Årea negativa (hueco)
                                </label>
                                <div class="flex items-center gap-2">
                                    <button id="btn-ejemplo-centroide" class="text-blue-600 text-sm font-semibold hover:underline">Cargar ejemplo r√°pido</button>
                                    <button id="btn-add-fig" class="bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition-colors">A√±adir</button>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h4 class="text-lg font-semibold mb-2 flex items-center gap-2"><span aria-hidden="true">üßÆ</span>Memoria de c√°lculo</h4>
                            <div class="overflow-x-auto rounded-xl border border-gray-200">
                                <table class="min-w-full divide-y divide-gray-200 text-sm">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="px-3 py-2 text-left text-gray-600 uppercase tracking-wide text-xs">Fig</th>
                                            <th class="px-3 py-2 text-right text-gray-600 uppercase tracking-wide text-xs">√Årea</th>
                                            <th class="px-3 py-2 text-right text-gray-600 uppercase tracking-wide text-xs">\(x_i\)</th>
                                            <th class="px-3 py-2 text-right text-gray-600 uppercase tracking-wide text-xs">\(y_i\)</th>
                                            <th class="px-3 py-2 text-right text-gray-600 uppercase tracking-wide text-xs">\(A_i x_i\)</th>
                                            <th class="px-3 py-2 text-right text-gray-600 uppercase tracking-wide text-xs">\(A_i y_i\)</th>
                                            <th class="px-3 py-2 text-center text-gray-600 uppercase tracking-wide text-xs">Acci√≥n</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabla-centroide" class="bg-white divide-y divide-gray-200">
                                    </tbody>
                                    <tfoot class="bg-gray-50 font-semibold text-sm">
                                        <tr>
                                            <td class="px-3 py-2 text-right">Œ£</td>
                                            <td class="px-3 py-2 text-right" id="sum-area">0.0</td>
                                            <td class="px-3 py-2"></td>
                                            <td class="px-3 py-2"></td>
                                            <td class="px-3 py-2 text-right" id="sum-ax">0.0</td>
                                            <td class="px-3 py-2 text-right" id="sum-ay">0.0</td>
                                            <td class="px-3 py-2"></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                            <p class="text-xs text-gray-500 mt-2">Consejo: conserva la coherencia de unidades (por ejemplo, todo en cent√≠metros).</p>
                        </div>
                    </div>

                    <!-- VISUALIZACI√ìN Y RESULTADOS -->
                    <div class="flex flex-col items-center gap-6 w-full">
                        <canvas id="simulacion-centroide" width="450" height="450" class="simulation-canvas w-full max-w-lg" role="img" aria-label="Representaci√≥n gr√°fica de las figuras y su centroide"></canvas>
                        <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 w-full max-w-lg text-center">
                            <h4 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Centroide compuesto \( (X_c, Y_c) \)</h4>
                            <p id="resultado-centroide" class="text-2xl font-bold text-blue-700 mt-1"></p>
                            <p id="aviso-centroide" class="text-xs text-blue-900/80 mt-2"></p>
                        </div>
                        <div id="resumen-centroide" class="w-full max-w-lg bg-gray-100 text-gray-700 text-sm p-4 rounded-xl space-y-1 leading-relaxed"></div>
                        <div class="flex flex-wrap gap-3 justify-center w-full max-w-lg">
                            <button id="btn-reset-centroide" class="bg-red-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-red-600 transition-colors">Reiniciar</button>
                        </div>
                        <div class="w-full max-w-lg bg-gray-100 text-gray-600 text-sm p-4 rounded-xl">
                            <h4 class="font-semibold text-gray-700 mb-2">Gu√≠a r√°pida de uso</h4>
                            <ul class="list-disc list-inside space-y-1">
                                <li>Define un origen mental (el lienzo lo dibuja en la esquina inferior izquierda).</li>
                                <li>Introduce rect√°ngulos positivos para material y marca ‚Äú√Årea negativa‚Äù para huecos.</li>
                                <li>Pasa el cursor sobre la tabla para resaltar cada figura en el lienzo.</li>
                                <li>Verifica que Œ£A no sea cero antes de confiar en \(X_c\) y \(Y_c\).</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white mt-12 border-t">
        <div class="container mx-auto px-6 py-4 text-center text-gray-500 text-sm">
            <p>&copy; 2025 Laboratorio Virtual de F√≠sica Mec√°nica. Un recurso educativo interactivo.</p>
            <p class="mt-1">Desarrollado para que la f√≠sica sea m√°s clara que el agua (literalmente).</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const g = 9.81;

            // NAVEGACI√ìN PRINCIPAL
            const btnArquimedes = document.getElementById('btn-arquimedes');
            const btnCentroide = document.getElementById('btn-centroide');
            const viewArquimedes = document.getElementById('view-arquimedes');
            const viewCentroide = document.getElementById('view-centroide');

            function switchView(activeView) {
                if (activeView === 'arquimedes') {
                    viewArquimedes.classList.remove('hidden');
                    viewCentroide.classList.add('hidden');
                    btnArquimedes.classList.add('tab-active');
                    btnArquimedes.classList.remove('tab-inactive');
                    btnCentroide.classList.add('tab-inactive');
                    btnCentroide.classList.remove('tab-active');
                    initArquimedes();
                } else {
                    viewArquimedes.classList.add('hidden');
                    viewCentroide.classList.remove('hidden');
                    btnArquimedes.classList.add('tab-inactive');
                    btnArquimedes.classList.remove('tab-active');
                    btnCentroide.classList.add('tab-active');
                    btnCentroide.classList.remove('tab-inactive');
                    initCentroide();
                }
            }

            btnArquimedes.addEventListener('click', () => switchView('arquimedes'));
            btnCentroide.addEventListener('click', () => switchView('centroide'));

            // L√ìGICA DE PESTA√ëAS (TABS)
            function setupTabs(viewPrefix) {
                const tabs = document.querySelectorAll(`.${viewPrefix}-tab`);
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        tabs.forEach(t => {
                            t.classList.remove('tab-active');
                            t.classList.add('tab-inactive');
                            document.getElementById(t.dataset.tab).classList.add('hidden');
                        });
                        tab.classList.add('tab-active');
                        tab.classList.remove('tab-inactive');
                        document.getElementById(tab.dataset.tab).classList.remove('hidden');
                    });
                });
            }
            setupTabs('arquimedes');
            setupTabs('centroide');

            // --- M√ìDULO ARQU√çMEDES ---
            const densidadObjetoSlider = document.getElementById('densidad-objeto');
            const densidadFluidoSlider = document.getElementById('densidad-fluido');
            const volumenObjetoSlider = document.getElementById('volumen-objeto');
            const valDensidadObjeto = document.getElementById('val-densidad-objeto');
            const valDensidadFluido = document.getElementById('val-densidad-fluido');
            const valVolumenObjeto = document.getElementById('val-volumen-objeto');
            const resultadoPeso = document.getElementById('resultado-peso');
            const resultadoEmpuje = document.getElementById('resultado-empuje');
            const resultadoVolumenSumergido = document.getElementById('resultado-volumen-sumergido');
            const resultadoDensidadRelativa = document.getElementById('resultado-densidad-relativa');
            const estadoFlotacion = document.getElementById('estado-flotacion');
            const explicacionFlotacion = document.getElementById('explicacion-flotacion');
            const canvasArquimedes = document.getElementById('simulacion-arquimedes');
            const ctxArquimedes = canvasArquimedes.getContext('2d');
            
            let chartFuerzas;

            function initArquimedes() {
                updateArquimedes();
                if (!chartFuerzas) {
                    const chartCtx = document.getElementById('grafico-fuerzas').getContext('2d');
                    chartFuerzas = new Chart(chartCtx, {
                        type: 'bar',
                        data: {
                            labels: ['Peso', 'Empuje'],
                            datasets: [{
                                label: 'Fuerza (N)',
                                data: [0, 0],
                                backgroundColor: ['#ef4444', '#3b82f6'],
                                borderColor: ['#dc2626', '#2563eb'],
                                borderWidth: 1,
                                borderRadius: 6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    ticks: { color: '#475569', font: { weight: 600 } }
                                },
                                y: {
                                    beginAtZero: true,
                                    title: { display: true, text: 'Fuerza (N)', color: '#475569', font: { weight: 600 } },
                                    ticks: { color: '#475569' },
                                    grid: { color: '#e5e7eb' }
                                }
                            },
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    callbacks: {
                                        label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(1)} N`
                                    }
                                }
                            }
                        }
                    });
                }
            }

            function updateArquimedes() {
                const densidadObjeto = parseFloat(densidadObjetoSlider.value);
                const densidadFluido = parseFloat(densidadFluidoSlider.value);
                const volumenObjeto = parseFloat(volumenObjetoSlider.value);

                valDensidadObjeto.textContent = `${densidadObjeto.toFixed(0)} kg/m¬≥`;
                valDensidadFluido.textContent = `${densidadFluido.toFixed(0)} kg/m¬≥`;
                valVolumenObjeto.textContent = `${volumenObjeto.toFixed(2)} m¬≥`;

                densidadObjetoSlider.setAttribute('aria-valuenow', densidadObjeto.toFixed(0));
                densidadFluidoSlider.setAttribute('aria-valuenow', densidadFluido.toFixed(0));
                volumenObjetoSlider.setAttribute('aria-valuenow', volumenObjeto.toFixed(2));

                const peso = densidadObjeto * volumenObjeto * g;
                const empujeMaximo = densidadFluido * volumenObjeto * g;

                let empujeActual;
                let volumenSumergido;
                let estado = '';
                let estadoBg = '';
                let estadoText = '';
                let narrativa = '';
                const densidadRelativa = densidadObjeto / densidadFluido;

                if (peso >= empujeMaximo) {
                    empujeActual = empujeMaximo;
                    volumenSumergido = volumenObjeto;
                    estado = 'SE HUNDE';
                    estadoBg = 'bg-red-100';
                    estadoText = 'text-red-700';
                    narrativa = `La densidad relativa es ${densidadRelativa.toFixed(2)} (> 1), por lo que el peso supera al empuje m√°ximo. El objeto desplaza todo su volumen y a√∫n as√≠ la fuerza neta apunta hacia abajo.`;
                } else {
                    empujeActual = peso;
                    volumenSumergido = peso / (densidadFluido * g);
                    const porcentajeSumergido = (volumenSumergido / volumenObjeto) * 100;
                    estado = porcentajeSumergido < 5 ? 'FLOTA CASI COMPLETO' : `FLOTA (${porcentajeSumergido.toFixed(1)}% sumergido)`;
                    estadoBg = 'bg-green-100';
                    estadoText = 'text-green-700';
                    narrativa = `La densidad relativa es ${densidadRelativa.toFixed(2)} (< 1), lo que implica equilibrio con solo ${volumenSumergido.toFixed(3)} m¬≥ sumergidos. El objeto desplaza la cantidad de fluido necesaria para igualar su peso.`;
                }

                resultadoPeso.textContent = `${peso.toFixed(1)} N`;
                resultadoEmpuje.textContent = `${empujeActual.toFixed(1)} N`;
                resultadoVolumenSumergido.textContent = `${volumenSumergido.toFixed(3)} m¬≥`;
                resultadoDensidadRelativa.textContent = densidadRelativa.toFixed(2);

                estadoFlotacion.textContent = estado;
                estadoFlotacion.className = `p-4 rounded-xl text-center text-xl font-bold transition-colors duration-300 ${estadoBg} ${estadoText}`;
                explicacionFlotacion.innerHTML = `<strong>Interpretaci√≥n:</strong> ${narrativa}`;

                drawArquimedes(densidadFluido, volumenSumergido, volumenObjeto, densidadRelativa >= 1);
                updateChart(peso, empujeActual);
            }

            function drawArquimedes(densidadFluido, volSumergido, volTotal, seHunde) {
                const W = canvasArquimedes.width;
                const H = canvasArquimedes.height;
                ctxArquimedes.clearRect(0, 0, W, H);

                const nivelAgua = H * 0.7;
                const densidadNormalizada = Math.min(Math.max((densidadFluido - 500) / 1300, 0), 1);
                const colorAgua = `rgba(59, 130, 246, ${0.25 + densidadNormalizada * 0.5})`;
                ctxArquimedes.fillStyle = colorAgua;
                ctxArquimedes.fillRect(0, nivelAgua, W, H - nivelAgua);

                ctxArquimedes.fillStyle = '#bfdbfe';
                ctxArquimedes.fillRect(0, nivelAgua - 8, W, 8);

                const escalaLineal = Math.cbrt(volTotal);
                const objW = W * 0.28 * escalaLineal;
                const objH = W * 0.28 * escalaLineal;
                const objX = (W - objW) / 2;

                const alturaSumergida = objH * Math.min(volSumergido / volTotal, 1);
                let objY = nivelAgua - alturaSumergida;

                if (seHunde) {
                    objY = nivelAgua + 10;
                    if (objY + objH > H - 15) {
                        objY = H - objH - 15;
                    }
                }

                const grad = ctxArquimedes.createLinearGradient(objX, objY, objX, objY + objH);
                grad.addColorStop(0, '#9ca3af');
                grad.addColorStop(1, '#6b7280');

                ctxArquimedes.fillStyle = grad;
                ctxArquimedes.strokeStyle = '#4b5563';
                ctxArquimedes.lineWidth = 2;
                ctxArquimedes.fillRect(objX, objY, objW, objH);
                ctxArquimedes.strokeRect(objX, objY, objW, objH);

                ctxArquimedes.fillStyle = 'rgba(59,130,246,0.45)';
                ctxArquimedes.fillRect(objX, nivelAgua, objW, alturaSumergida);

                const centroX = W / 2;
                const centroY = objY + objH / 2;

                ctxArquimedes.strokeStyle = '#ef4444';
                ctxArquimedes.lineWidth = 3;
                ctxArquimedes.beginPath();
                ctxArquimedes.moveTo(centroX, centroY);
                ctxArquimedes.lineTo(centroX, centroY + 60);
                ctxArquimedes.stroke();
                ctxArquimedes.fillStyle = '#ef4444';
                ctxArquimedes.font = '14px Inter';
                ctxArquimedes.fillText('Peso', centroX + 10, centroY + 45);

                ctxArquimedes.strokeStyle = '#3b82f6';
                ctxArquimedes.beginPath();
                ctxArquimedes.moveTo(centroX, centroY);
                ctxArquimedes.lineTo(centroX, centroY - 60);
                ctxArquimedes.stroke();
                ctxArquimedes.fillStyle = '#2563eb';
                ctxArquimedes.fillText('Empuje', centroX - 65, centroY - 40);

                ctxArquimedes.fillStyle = '#1f2937';
                ctxArquimedes.font = '13px Inter';
                ctxArquimedes.fillText('Superficie del fluido', 20, nivelAgua - 12);
            }
            
            function updateChart(peso, empuje) {
                if (chartFuerzas) {
                    const maxValor = Math.max(peso, empuje, 100);
                    const margen = maxValor * 0.2;
                    chartFuerzas.data.datasets[0].data[0] = peso;
                    chartFuerzas.data.datasets[0].data[1] = empuje;
                    chartFuerzas.options.scales.y.max = maxValor + margen;
                    chartFuerzas.update();
                }
            }
            
            [densidadObjetoSlider, densidadFluidoSlider, volumenObjetoSlider].forEach(slider => slider.addEventListener('input', updateArquimedes));

            // --- M√ìDULO CENTROIDE ---
            const canvasCentroide = document.getElementById('simulacion-centroide');
            const ctxCentroide = canvasCentroide.getContext('2d');
            const btnAddFig = document.getElementById('btn-add-fig');
            const btnResetCentroide = document.getElementById('btn-reset-centroide');
            const btnEjemploCentroide = document.getElementById('btn-ejemplo-centroide');
            const tablaCentroideBody = document.getElementById('tabla-centroide');
            const sumAreaCell = document.getElementById('sum-area');
            const sumAxCell = document.getElementById('sum-ax');
            const sumAyCell = document.getElementById('sum-ay');
            const resultadoCentroide = document.getElementById('resultado-centroide');
            const avisoCentroide = document.getElementById('aviso-centroide');
            const resumenCentroide = document.getElementById('resumen-centroide');
            
            let figuras = [];
            let figIdCounter = 0;
            let figuraResaltada = null;
            let ultimoCentroide = { Xc: null, Yc: null, sumArea: 0, sumAx: 0, sumAy: 0 };

            function initCentroide() {
                drawCentroide();
                actualizarResumen();
            }

            function addFigura(fromExample = false) {
                const xInput = document.getElementById('fig-x');
                const yInput = document.getElementById('fig-y');
                const wInput = document.getElementById('fig-w');
                const hInput = document.getElementById('fig-h');
                const x = parseFloat(xInput.value);
                const y = parseFloat(yInput.value);
                const w = parseFloat(wInput.value);
                const h = parseFloat(hInput.value);
                const isNegative = document.getElementById('fig-negativa').checked;

                if ([x, y, w, h].some(val => isNaN(val))) {
                    alert('Por favor, introduce valores num√©ricos v√°lidos.');
                    return;
                }
                if (w <= 0 || h <= 0) {
                    alert('El ancho y el alto deben ser positivos.');
                    return;
                }
                
                figIdCounter++;
                const area = w * h * (isNegative ? -1 : 1);
                const xi = x + w / 2;
                const yi = y + h / 2;

                figuras.push({ id: figIdCounter, x, y, w, h, isNegative, area, xi, yi });
                
                if (!fromExample) {
                    figuraResaltada = figIdCounter;
                }
                updateCentroide();
            }

            function cargarEjemplo() {
                figuras = [];
                figIdCounter = 0;
                const ejemplo = [
                    { x: 0, y: 0, w: 200, h: 120, isNegative: false },
                    { x: 50, y: 120, w: 100, h: 80, isNegative: false },
                    { x: 80, y: 40, w: 40, h: 40, isNegative: true }
                ];
                ejemplo.forEach(fig => {
                    document.getElementById('fig-x').value = fig.x;
                    document.getElementById('fig-y').value = fig.y;
                    document.getElementById('fig-w').value = fig.w;
                    document.getElementById('fig-h').value = fig.h;
                    document.getElementById('fig-negativa').checked = fig.isNegative;
                    addFigura(true);
                });
                figuraResaltada = figuras.at(-1)?.id ?? null;
                updateCentroide();
            }

            function removeFigura(id) {
                figuras = figuras.filter(fig => fig.id !== id);
                figuraResaltada = null;
                updateCentroide();
            }

            function updateCentroide() {
                renderTablaCentroide();
                calculateAndDrawCentroide();
            }
            
            function calculateAndDrawCentroide() {
                let sumArea = 0;
                let sumAx = 0;
                let sumAy = 0;
                
                figuras.forEach(fig => {
                    sumArea += fig.area;
                    sumAx += fig.area * fig.xi;
                    sumAy += fig.area * fig.yi;
                });
                
                let Xc = null;
                let Yc = null;
                avisoCentroide.textContent = '';
                
                if (Math.abs(sumArea) > 1e-6) {
                    Xc = sumAx / sumArea;
                    Yc = sumAy / sumArea;
                    resultadoCentroide.textContent = `(${Xc.toFixed(2)}, ${Yc.toFixed(2)})`;
                    if (figuras.length === 0) {
                        resultadoCentroide.textContent = '(‚Äî, ‚Äî)';
                    }
                } else {
                    resultadoCentroide.textContent = '(No definido)';
                    if (figuras.length > 0) {
                        avisoCentroide.textContent = 'La suma de √°reas es cero: el centroide no est√° definido. Ajusta las √°reas o elimina alg√∫n hueco.';
                    } else {
                        avisoCentroide.textContent = 'Agrega al menos una figura para calcular el centroide.';
                    }
                }

                ultimoCentroide = { Xc, Yc, sumArea, sumAx, sumAy };
                sumAreaCell.textContent = sumArea.toFixed(2);
                sumAxCell.textContent = sumAx.toFixed(2);
                sumAyCell.textContent = sumAy.toFixed(2);

                actualizarResumen();
                drawCentroide(Xc, Yc);
            }

            function actualizarResumen() {
                const { sumArea, sumAx, sumAy, Xc, Yc } = ultimoCentroide;
                const piezas = figuras.length;
                const mensajeBase = piezas === 0
                    ? 'A√±ade rect√°ngulos para comenzar. Puedes cargar el ejemplo r√°pido para ver un caso t√≠pico de √°rea con hueco.'
                    : `Actualmente hay ${piezas} ${piezas === 1 ? 'figura' : 'figuras'} en el conjunto.`;
                
                const detalles = `
                    <p>${mensajeBase}</p>
                    <p>Œ£A = ${sumArea.toFixed(2)} unidades¬≤, Œ£(A·µ¢x·µ¢) = ${sumAx.toFixed(2)} unidades¬≥, Œ£(A·µ¢y·µ¢) = ${sumAy.toFixed(2)} unidades¬≥.</p>
                    <p>${Xc !== null ? `El centroide se ubica a ${Xc.toFixed(2)} unidades en X y ${Yc?.toFixed(2) ?? '‚Äî'} en Y respecto al origen.` : 'A√∫n no hay centroide definido.'}</p>
                `;
                resumenCentroide.innerHTML = detalles;
            }
            
            function renderTablaCentroide() {
                tablaCentroideBody.innerHTML = '';
                figuras.forEach((fig, index) => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-blue-50/70 transition-colors cursor-pointer';
                    row.innerHTML = `
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-600">${index + 1} ${fig.isNegative ? '(-)' : '(+)'}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-600 text-right">${fig.area.toFixed(1)}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-600 text-right">${fig.xi.toFixed(1)}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-600 text-right">${fig.yi.toFixed(1)}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-600 text-right">${(fig.area * fig.xi).toFixed(1)}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-600 text-right">${(fig.area * fig.yi).toFixed(1)}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-sm text-center">
                            <button data-id="${fig.id}" class="remove-fig-btn text-red-500 hover:text-red-700 text-lg leading-none" aria-label="Eliminar figura ${index + 1}">&times;</button>
                        </td>
                    `;
                    row.addEventListener('mouseenter', () => {
                        figuraResaltada = fig.id;
                        drawCentroide(ultimoCentroide.Xc, ultimoCentroide.Yc);
                    });
                    row.addEventListener('mouseleave', () => {
                        figuraResaltada = null;
                        drawCentroide(ultimoCentroide.Xc, ultimoCentroide.Yc);
                    });
                    tablaCentroideBody.appendChild(row);
                });

                document.querySelectorAll('.remove-fig-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const id = parseInt(e.currentTarget.dataset.id, 10);
                        removeFigura(id);
                    });
                });
            }

            function drawCentroide(Xc, Yc) {
                const W = canvasCentroide.width;
                const H = canvasCentroide.height;
                ctxCentroide.clearRect(0, 0, W, H);

                const padding = 30;
                const originOffset = 60;
                const maxX = Math.max(120, ...figuras.map(fig => fig.x + fig.w));
                const maxY = Math.max(120, ...figuras.map(fig => fig.y + fig.h));
                const scaleX = (W - originOffset - padding) / maxX;
                const scaleY = (H - originOffset - padding) / maxY;
                const scale = Math.min(scaleX, scaleY);

                const originX = originOffset;
                const originY = H - originOffset;

                function toCanvasX(x) {
                    return originX + x * scale;
                }
                function toCanvasY(y) {
                    return originY - y * scale;
                }

                const stepUnits = calcularPasoGrid(scale);
                ctxCentroide.save();
                ctxCentroide.strokeStyle = '#e5e7eb';
                ctxCentroide.lineWidth = 1;
                for (let x = 0; x <= maxX + stepUnits; x += stepUnits) {
                    const canvasX = toCanvasX(x);
                    ctxCentroide.beginPath();
                    ctxCentroide.moveTo(canvasX, padding / 2);
                    ctxCentroide.lineTo(canvasX, H - padding / 2);
                    ctxCentroide.stroke();
                }
                for (let y = 0; y <= maxY + stepUnits; y += stepUnits) {
                    const canvasY = toCanvasY(y);
                    ctxCentroide.beginPath();
                    ctxCentroide.moveTo(padding / 2, canvasY);
                    ctxCentroide.lineTo(W - padding / 2, canvasY);
                    ctxCentroide.stroke();
                }
                ctxCentroide.restore();

                ctxCentroide.save();
                ctxCentroide.strokeStyle = '#9ca3af';
                ctxCentroide.lineWidth = 2;
                ctxCentroide.beginPath();
                ctxCentroide.moveTo(originX, padding / 2);
                ctxCentroide.lineTo(originX, H - padding / 2);
                ctxCentroide.stroke();
                ctxCentroide.beginPath();
                ctxCentroide.moveTo(padding / 2, originY);
                ctxCentroide.lineTo(W - padding / 2, originY);
                ctxCentroide.stroke();

                ctxCentroide.fillStyle = '#4b5563';
                ctxCentroide.font = '14px Inter';
                ctxCentroide.fillText('X', W - padding, originY - 10);
                ctxCentroide.fillText('Y', originX + 10, padding);

                ctxCentroide.fillStyle = '#9ca3af';
                ctxCentroide.font = '11px Inter';
                for (let x = stepUnits; x <= maxX; x += stepUnits) {
                    const canvasX = toCanvasX(x);
                    ctxCentroide.fillText(x.toString(), canvasX - 8, originY + 16);
                }
                for (let y = stepUnits; y <= maxY; y += stepUnits) {
                    const canvasY = toCanvasY(y);
                    ctxCentroide.fillText(y.toString(), originX - 24, canvasY + 4);
                }
                ctxCentroide.restore();

                figuras.forEach(fig => {
                    ctxCentroide.save();
                    const drawX = toCanvasX(fig.x);
                    const drawY = toCanvasY(fig.y + fig.h);
                    const drawW = fig.w * scale;
                    const drawH = fig.h * scale;

                    const fillStyle = fig.isNegative ? 'rgba(239, 68, 68, 0.35)' : 'rgba(59, 130, 246, 0.35)';
                    const strokeStyle = fig.isNegative ? '#b91c1c' : '#1d4ed8';

                    ctxCentroide.setLineDash(fig.isNegative ? [6, 4] : []);
                    ctxCentroide.lineWidth = figuraResaltada === fig.id ? 3 : 1.5;
                    ctxCentroide.fillStyle = fillStyle;
                    ctxCentroide.strokeStyle = strokeStyle;

                    ctxCentroide.fillRect(drawX, drawY, drawW, drawH);
                    ctxCentroide.strokeRect(drawX, drawY, drawW, drawH);

                    const centroidX = toCanvasX(fig.xi);
                    const centroidY = toCanvasY(fig.yi);
                    ctxCentroide.fillStyle = '#475569';
                    ctxCentroide.beginPath();
                    ctxCentroide.arc(centroidX, centroidY, figuraResaltada === fig.id ? 5 : 4, 0, 2 * Math.PI);
                    ctxCentroide.fill();
                    ctxCentroide.restore();
                });
                
                if (Xc !== null && Yc !== null) {
                    ctxCentroide.save();
                    const finalX = toCanvasX(Xc);
                    const finalY = toCanvasY(Yc);
                    ctxCentroide.strokeStyle = '#16a34a';
                    ctxCentroide.lineWidth = 3;
                    ctxCentroide.beginPath();
                    ctxCentroide.moveTo(finalX - 8, finalY - 8);
                    ctxCentroide.lineTo(finalX + 8, finalY + 8);
                    ctxCentroide.moveTo(finalX + 8, finalY - 8);
                    ctxCentroide.lineTo(finalX - 8, finalY + 8);
                    ctxCentroide.stroke();
                    ctxCentroide.fillStyle = '#16a34a';
                    ctxCentroide.font = '13px Inter';
                    ctxCentroide.fillText('Centroide', finalX + 10, finalY - 10);
                    ctxCentroide.restore();
                }
            }

            function calcularPasoGrid(scale) {
                const desiredPixels = 45;
                const rawStep = desiredPixels / scale;
                if (!isFinite(rawStep) || rawStep <= 0) return 50;
                const exponent = Math.floor(Math.log10(rawStep));
                const base = Math.pow(10, exponent);
                const multiples = [1, 2, 5, 10];
                for (const m of multiples) {
                    if (rawStep <= base * m) {
                        return base * m;
                    }
                }
                return base * 10;
            }

            btnAddFig.addEventListener('click', () => addFigura());
            btnResetCentroide.addEventListener('click', () => {
                figuras = [];
                figuraResaltada = null;
                ultimoCentroide = { Xc: null, Yc: null, sumArea: 0, sumAx: 0, sumAy: 0 };
                updateCentroide();
            });
            btnEjemploCentroide.addEventListener('click', cargarEjemplo);

            // INICIALIZACI√ìN
            switchView('arquimedes');
        });
    </script>
</body>
</html>